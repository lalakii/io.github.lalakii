-1!=location.hostname.indexOf("lalaki.icu")&&(location.href="https://lalaki.cn");const postForm=document.getElementById("postForm");function safeLogout(){location.href="/ala/quit.html?v="+Math.random(),logout()}function imageChoose(e,t){let o="";switch(e){case 0:o=t;break;case 1:o='<img src="'+t+'" alt="laji">';break;case 2:o="![laji]("+t+")";break;case 3:o="[url="+location.origin+"][img]"+t+"[/img][/url]";break;case 4:o="!"+t+"!";break;case 5:o="image::"+t+"["+location.origin+"]"}document.getElementById("imgURI").value=o}function uploading(){window.progressVal=0,document.getElementById("progressBar").style.display="block",window.lalakiProgressHandle=setInterval((function(){document.querySelector(".progress-value").style.width=window.progressVal+"%",100==window.progressVal&&(window.progressVal=0),window.progressVal+=5}),30)}function logout(){fetch("/?tag=quit").then((e=>{401==e.status&&location.reload()}))}function show_sys_info(){let e=document.getElementById("sysinfo");e.style.display="inline-block"==e.style.display?"none":"inline-block"}window.mSelectIndex=0,window.lalakiProgressHandle=null,window.onload=()=>{if(null==document.querySelector(".logout")){const e=document.querySelector(".login-cursor"),t=document.querySelector("#la_cookies");t.style.position="fixed",t.style.bottom="0";let o=!0;e.onclick=()=>{if(!o)return;o=!1;let e=0,l=setInterval((()=>{null!=t&&(t.style.border=1==(1&e)?"2px solid red":"2px solid transparent"),e>11&&(o=!0,clearInterval(l)),e++}),200)};const l=setInterval((()=>{if(null==t||0==t.offsetHeight){let t=document.querySelector(".cf-turnstile input");null!=t&&""!=(t.value+"").trim()&&(null!=e&&(e.href="/ala/login.html"),Cookies.set("bv2",t.value),clearInterval(l))}}),10)}if(null==localStorage.getItem("accept_cookies")){const e=document.querySelector("#la_cookies");e.removeAttribute("hidden"),document.querySelector("#la_cookies_ok").onclick=()=>{e.setAttribute("hidden","hidden"),localStorage.setItem("accept_cookies","1")}}if(document.querySelector(".btn-copy").onclick=function(){let e=document.getElementById("imgURI");e.select();let t=e.value;e.setSelectionRange(0,t.length);try{document.execCommand("copy")}catch(e){}navigator.clipboard.writeText(t)},/(weixin|wechat)/i.test(navigator.userAgent))return void alert("WeChat built-in browser is not supported.");document.getElementById("fileSelect").onchange=function(e){let t=document.querySelector(".btn-upload");t.setAttribute("for",""),window.oldHtml=t.innerHTML,t.innerHTML="Uploading...",document.getElementById("imgURI").value="",uploading(),fetch(postForm.action,{method:"POST",body:new FormData(postForm)}).then((e=>e.json())).then((e=>{let o=e.insert;if("isApkPublishOK"==o){let t=e.msg,o=e.name+("0000"==e.sha256?"发布失败":" 发布成功")+"！\n\nSHA256: "+e.sha256;null!=t&&null!=t&&(o+="\n\n"+t),alert(o)}else if(o>=0){let t=location.origin+"/laji/"+e.crc32+".JPEG";window.lalakiJPEGURI=t,imageChoose(window.mSelectIndex,window.lalakiJPEGURI)}else-2==o?alert("Not logged in or incorrect password."):-6==o&&alert("Upload failed, please try again!");setTimeout((function(){document.getElementById("progressBar").style.display="none",null!=window.lalakiProgressHandle&&(clearInterval(window.lalakiProgressHandle),window.lalakiProgressHandle=null,t.setAttribute("for","fileSelect"),t.innerHTML=window.oldHtml,document.getElementById("fileSelect").value="")}),500)})).catch((e=>{location.reload()}))};const e=document.querySelector(".combox");document.getElementById("mCombox").onclick=function(){if("none"==e.style.display){e.style.display="inline-block";let t=document.querySelector("#mCombox span"),o=t.offsetLeft+(t.offsetWidth-e.offsetWidth)/2;document.querySelector(".combox-parent").style.left=o+"px"}else e.style.display="none"},document.querySelectorAll(".combox li").forEach((e=>{e.onclick=function(e){let t=e.target.innerHTML,o=-1;document.querySelector("#mCombox span").innerHTML=t,document.querySelectorAll(".combox li").forEach(((e,l)=>{e.innerText==t?(window.mSelectIndex=o=l,e.setAttribute("hidden","hidden")):e.removeAttribute("hidden")})),null!=window.lalakiJPEGURI&&null!=window.lalakiJPEGURI&&imageChoose(o,window.lalakiJPEGURI)}})),window.onresize=function(){e.style.display="none"}};